- pipeline: "Build and Deploy Python Webapp"
  events:
  - type: "PUSH"
    refs:
    - "refs/heads/master"
  fail_on_prepare_env_warning: true
  resources: "NANO"
  actions:
  - action: "nosetests"
    type: "BUILD"
    docker_image_name: "library/python"
    docker_image_tag: "latest"
    execute_commands:
    - "pip install yfinance --upgrade --no-cache-dir"
    cached_dirs:
    - "/root/.cache/pip"
    shell: "BASH"
  - action: "Build Docker image"
    type: "DOCKERFILE"
    integration: "Docker_Hub"
    dockerfile_path: ""
    docker_registry: "DOCKER_HUB"
    do_not_prune_images: true
  - action: "Send Discord message"
    type: "DISCORD2"
    notification_url: "https://discord.com/api/webhooks/1272394942349836421/7jeLD2etmhld12C3uw-CauUGKn25wbt8qWYZCIDo4gADAohVwKh8jeNyrzq6V6XSiGtc"
    content: "[#$BUDDY_EXECUTION_ID] $BUDDY_PIPELINE_NAME by $BUDDY_TRIGGERING_ACTOR"
    attachments:
    - "{\"title\":\"Details\",\"url\":\"$BUDDY_EXECUTION_URL\",\"fields\":[{\"name\":\"Status\",\"value\":\"Successful execution\"},{\"name\":\"Revision\",\"value\":\"$BUDDY_EXECUTION_REVISION\"},{\"name\":\"Pipeline\",\"value\":\"$BUDDY_PIPELINE_NAME\"},{\"name\":\"Project\",\"value\":\"$BUDDY_PROJECT_NAME\"}]}"
